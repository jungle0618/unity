# ItemManager å¿«é€Ÿè¨­å®šæŒ‡å—

## âœ… å·²å‰µå»ºçš„æª”æ¡ˆ

### 1. æ ¸å¿ƒç³»çµ±æª”æ¡ˆ
- âœ… `Data/itemdata.txt` - ç‰©å“è³‡æ–™æª”æ¡ˆ
- âœ… `Item/WorldItem.cs` - å ´æ™¯ç‰©å“é¡åˆ¥
- âœ… `Game/ItemManager.cs` - ç‰©å“ç®¡ç†å™¨

### 2. ç¯„ä¾‹å’Œæ–‡ä»¶
- âœ… `Item/ItemPickupExample.cs` - æ’¿å–ç¯„ä¾‹è…³æœ¬
- âœ… `Item/ItemManager_README.md` - å®Œæ•´ä½¿ç”¨èªªæ˜

---

## ğŸš€ 5 åˆ†é˜å¿«é€Ÿè¨­å®š

### æ­¥é©Ÿ 1ï¼šå‰µå»º ItemManager GameObject
1. å ´æ™¯ä¸­å‰µå»ºç©ºç‰©ä»¶ï¼Œå‘½å `ItemManager`
2. æ·»åŠ  `ItemManager` çµ„ä»¶

### æ­¥é©Ÿ 2ï¼šè¨­å®š ItemManager
```
Inspector è¨­å®šï¼š
â”œâ”€â”€ Item Data File: é¸æ“‡ itemdata.txt
â”œâ”€â”€ World Item Prefab: (ç•™ç©ºä½¿ç”¨é è¨­)
â”œâ”€â”€ Item Prefab Mappings: (å±•é–‹)
â”‚   â”œâ”€â”€ Size: 3
â”‚   â”œâ”€â”€ [0] Item Type: "Sword" â†’ Item Prefab: (æ‹–å…¥ Sword Prefab)
â”‚   â”œâ”€â”€ [1] Item Type: "Bow"   â†’ Item Prefab: (æ‹–å…¥ Bow Prefab)
â”‚   â””â”€â”€ [2] Item Type: "Knife" â†’ Item Prefab: (æ‹–å…¥ Knife Prefab)
â”œâ”€â”€ World Item Scale: (1, 1, 1) â† æ•£è½ç‰©å“çš„å›ºå®šå¤§å°
â”œâ”€â”€ Default Pickup Range: 2.0
â”œâ”€â”€ Show Debug Info: âœ“
â””â”€â”€ Show Gizmos: âœ“
```

### æ­¥é©Ÿ 3ï¼šç·¨è¼¯ç‰©å“ä½ç½®
æ‰“é–‹ `Data/itemdata.txt`ï¼Œè¨­å®šç‰©å“ä½ç½®ï¼š
```
0,Sword,25,30,0
1,Bow,45,20,0
2,Knife,60,15,0
```

### æ­¥é©Ÿ 4ï¼šæ·»åŠ æ’¿å–åŠŸèƒ½åˆ°ç©å®¶
é¸æ“‡ Player GameObjectï¼Œæ·»åŠ  `ItemPickupExample` çµ„ä»¶ï¼š
```
Inspector è¨­å®šï¼š
â”œâ”€â”€ Pickup Range: 2.0
â”œâ”€â”€ Pickup Key: E
â”œâ”€â”€ Is Player: âœ“
â””â”€â”€ Show Debug Info: âœ“
```

### æ­¥é©Ÿ 5ï¼šæ¸¬è©¦
1. é‹è¡ŒéŠæˆ²
2. èµ°åˆ°ç‰©å“é™„è¿‘ï¼ˆScene è¦–åœ–æœƒé¡¯ç¤ºé»ƒè‰²åœ“åœˆï¼‰
3. æŒ‰ `E` éµæ’¿å–ç‰©å“
4. æª¢æŸ¥ Console æ˜¯å¦é¡¯ç¤ºæ’¿å–æˆåŠŸè¨Šæ¯

---

## ğŸ“ åœ¨ç¾æœ‰ç³»çµ±ä¸­æ•´åˆ

### æ–¹æ³• 1ï¼šåœ¨ Player.cs ä¸­æ·»åŠ æ’¿å–åŠŸèƒ½

```csharp
public class Player : MonoBehaviour
{
    private ItemManager itemManager;
    private ItemHolder itemHolder;
    
    private void Start()
    {
        itemManager = FindObjectOfType<ItemManager>();
        itemHolder = GetComponent<ItemHolder>();
    }
    
    private void Update()
    {
        // æ’¿å–ç‰©å“
        if (Input.GetKeyDown(KeyCode.E))
        {
            itemManager?.TryPickupItem(transform.position, itemHolder, 2f);
        }
    }
}
```

### æ–¹æ³• 2ï¼šåœ¨ Enemy.cs ä¸­æ·»åŠ è‡ªå‹•æ’¿å–

```csharp
public class Enemy : MonoBehaviour
{
    private ItemManager itemManager;
    private ItemHolder itemHolder;
    private float lastPickupTime;
    
    private void Start()
    {
        itemManager = FindObjectOfType<ItemManager>();
        itemHolder = GetComponent<ItemHolder>();
    }
    
    private void Update()
    {
        // æ¯ 5 ç§’å˜—è©¦æ’¿å–ä¸€æ¬¡
        if (Time.time - lastPickupTime > 5f)
        {
            lastPickupTime = Time.time;
            itemManager?.TryPickupItem(transform.position, itemHolder, 3f);
        }
    }
}
```

---

## ğŸ¯ å¸¸ç”¨ API

```csharp
// 1. æ’¿å–æœ€è¿‘çš„ç‰©å“
bool success = itemManager.TryPickupItem(
    transform.position,  // å‘¼å«è€…ä½ç½®
    itemHolder,         // ç›®æ¨™ ItemHolder
    2f                  // æ’¿å–ç¯„åœ
);

// 2. æ’¿å–æŒ‡å®šé¡å‹çš„ç‰©å“
bool success = itemManager.TryPickupItemByType(
    "Sword",            // ç‰©å“é¡å‹
    transform.position, // å‘¼å«è€…ä½ç½®
    itemHolder,        // ç›®æ¨™ ItemHolder
    2f                 // æ’¿å–ç¯„åœ
);

// 3. ç²å–æ‰€æœ‰å‰©é¤˜ç‰©å“
List<WorldItem> items = itemManager.GetAllSpawnedItems();

// 4. ç²å–ç‰©å“çµ±è¨ˆ
int total = itemManager.TotalItemCount;      // ç¸½ç‰©å“æ•¸
int remaining = itemManager.RemainingItemCount; // å‰©é¤˜ç‰©å“æ•¸
int pickedUp = itemManager.PickedUpItemCount;   // å·²æ’¿å–æ•¸é‡

// 5. é‡æ–°ç”Ÿæˆæ‰€æœ‰ç‰©å“ï¼ˆé‡æ–°é–‹å§‹éŠæˆ²æ™‚ï¼‰
itemManager.RespawnAllItems();
```

---

## ğŸ”§ å¸¸è¦‹è¨­å®š

### é…ç½® 1ï¼šç©å®¶æ‰‹å‹•æ’¿å–
```csharp
// ItemPickupExample è¨­å®š
- Is Player: âœ“
- Pickup Key: E
- Pickup Range: 2.0
- Auto Pickup Enabled: âœ—
```

### é…ç½® 2ï¼šæ•µäººè‡ªå‹•æ’¿å–æ­¦å™¨
```csharp
// ItemPickupExample è¨­å®š
- Is Player: âœ—
- Auto Pickup Enabled: âœ“
- Auto Pickup Interval: 5.0
- Preferred Item Types: ["Sword", "Bow"]
```

### é…ç½® 3ï¼šæ¥è§¸å³æ’¿å–
åœ¨ ItemManager ä¸­ï¼š
```csharp
- Auto Pickup On Contact: âœ“
```

---

## ğŸ“Š ç‰©å“è³‡æ–™æ ¼å¼

### itemdata.txt æ ¼å¼
```
# è¨»é‡‹è¡Œä»¥ # é–‹é ­
ItemIndex,ItemType,x,y,z

# ç¯„ä¾‹
0,Sword,25,30,0    # ç¬¬ä¸€æŠŠåŠ
1,Bow,45,20,0      # ç¬¬ä¸€æŠŠå¼“
2,Knife,60,15,0    # ç¬¬ä¸€æŠŠåˆ€
```

### é‡è¦æé†’
- `ItemType` å¿…é ˆèˆ‡ ItemManager çš„ `Item Prefab Mappings` ä¸€è‡´
- åº§æ¨™ä½¿ç”¨ä¸–ç•Œåº§æ¨™ç³»çµ±
- ç´¢å¼•å¯ä»¥ä¸é€£çºŒï¼ˆä¾‹å¦‚ï¼š0, 1, 5, 10ï¼‰

---

## ğŸ› å•é¡Œæ’é™¤

### ç‰©å“æ²’æœ‰ç”Ÿæˆ
- âœ“ æª¢æŸ¥ itemdata.txt æ˜¯å¦æ­£ç¢ºæŒ‡å®š
- âœ“ æª¢æŸ¥ Item Prefab Mappings æ˜¯å¦è¨­å®š
- âœ“ æª¢æŸ¥ ItemType åç¨±æ˜¯å¦å®Œå…¨ä¸€è‡´ï¼ˆå€åˆ†å¤§å°å¯«ï¼‰

### ç„¡æ³•æ’¿å–ç‰©å“
- âœ“ æª¢æŸ¥è·é›¢æ˜¯å¦åœ¨ pickupRange å…§
- âœ“ æª¢æŸ¥ ItemHolder æ˜¯å¦å­˜åœ¨
- âœ“ å•Ÿç”¨ Show Debug Info æŸ¥çœ‹è©³ç´°è¨Šæ¯

### Scene è¦–åœ–çœ‹ä¸åˆ° Gizmos
- âœ“ ItemManager çš„ Show Gizmos æ˜¯å¦å•Ÿç”¨
- âœ“ Unity Scene è¦–åœ–å³ä¸Šè§’çš„ Gizmos æŒ‰éˆ•æ˜¯å¦é–‹å•Ÿ

---

## ğŸ“š é€²éšåŠŸèƒ½

### æ·»åŠ æ’¿å–éŸ³æ•ˆ
```csharp
private void OnItemPickedUp()
{
    // æ’­æ”¾éŸ³æ•ˆ
    AudioManager.Instance.PlaySound("ItemPickup");
}
```

### æ·»åŠ æ’¿å–ç‰¹æ•ˆ
```csharp
private void OnItemPickedUp()
{
    // æ’­æ”¾ç²’å­ç‰¹æ•ˆ
    ParticleSystem effect = Instantiate(pickupEffectPrefab, transform.position, Quaternion.identity);
    Destroy(effect.gameObject, 2f);
}
```

### ç‰©å“å“è³ªç³»çµ±
ä¿®æ”¹ itemdata.txt æ ¼å¼ï¼š
```
# æ ¼å¼ï¼šItemIndex,ItemType,x,y,z,Quality
0,Sword,25,30,0,Rare
1,Bow,45,20,0,Epic
```

---

## âœ¨ å®Œæˆï¼

æ‚¨ç¾åœ¨æ“æœ‰å®Œæ•´çš„ç‰©å“ç®¡ç†ç³»çµ±ï¼

**ä¸‹ä¸€æ­¥å»ºè­°ï¼š**
1. æ¸¬è©¦åŸºæœ¬æ’¿å–åŠŸèƒ½
2. æ ¹æ“šéŠæˆ²éœ€æ±‚èª¿æ•´æ’¿å–ç¯„åœ
3. æ·»åŠ éŸ³æ•ˆå’Œè¦–è¦ºç‰¹æ•ˆ
4. æ“´å±•ç‰©å“é¡å‹å’Œå±¬æ€§

**éœ€è¦å¹«åŠ©ï¼Ÿ**
æŸ¥çœ‹ `ItemManager_README.md` ç²å–å®Œæ•´æ–‡ä»¶ï¼

