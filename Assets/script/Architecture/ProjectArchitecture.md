# å°ˆæ¡ˆæ¶æ§‹æ–‡æª”

> **å°ˆæ¡ˆåç¨±**ï¼š2D æ½›è¡Œç­–ç•¥éŠæˆ²  
> **æœ€å¾Œæ›´æ–°**ï¼š2025-11-03  
> **æ¶æ§‹ç‰ˆæœ¬**ï¼šv2.1ï¼ˆæ™ºèƒ½è¿½æ“Šç³»çµ±å®Œæˆï¼‰

---

## ğŸ“‹ ç›®éŒ„

1. [å°ˆæ¡ˆæ¦‚è¿°](#å°ˆæ¡ˆæ¦‚è¿°)
2. [æ ¸å¿ƒæ¶æ§‹è¨­è¨ˆ](#æ ¸å¿ƒæ¶æ§‹è¨­è¨ˆ)
3. [å¯¦é«”ç³»çµ±](#å¯¦é«”ç³»çµ±)
4. [æ•µäººAIç³»çµ±](#æ•µäººaiç³»çµ±)
5. [æ­¦å™¨èˆ‡ç‰©å“ç³»çµ±](#æ­¦å™¨èˆ‡ç‰©å“ç³»çµ±)
6. [å±éšªä¿‚æ•¸ç³»çµ±](#å±éšªä¿‚æ•¸ç³»çµ±)
7. [æ”å½±æ©Ÿç³»çµ±](#æ”å½±æ©Ÿç³»çµ±)
8. [éŠæˆ²ç®¡ç†ç³»çµ±](#éŠæˆ²ç®¡ç†ç³»çµ±)
9. [è³‡æ–™é©…å‹•è¨­è¨ˆ](#è³‡æ–™é©…å‹•è¨­è¨ˆ)
10. [UIç³»çµ±](#uiç³»çµ±)
11. [éŠæˆ²ç©æ³•æ©Ÿåˆ¶](#éŠæˆ²ç©æ³•æ©Ÿåˆ¶)
12. [æŠ€è¡“äº®é»](#æŠ€è¡“äº®é»)
13. [æª”æ¡ˆçµæ§‹](#æª”æ¡ˆçµæ§‹)

---

## å°ˆæ¡ˆæ¦‚è¿°

### éŠæˆ²é¡å‹
2D ä¿¯è¦–æ½›è¡Œç­–ç•¥éŠæˆ²

### æ ¸å¿ƒç©æ³•
- ç©å®¶éœ€è¦æ½›å…¥æ•µäººåŸºåœ°ï¼Œæ“Šæ®ºç›®æ¨™ä¸¦å®‰å…¨é€ƒé›¢
- é¿å…è¢«å®ˆè¡›ç™¼ç¾ï¼Œç®¡ç†å±éšªä¿‚æ•¸
- æ”¶é›†æ­¦å™¨å’Œç‰©å“ï¼Œè¦åŠƒæœ€ä½³è·¯ç·š
- ä½¿ç”¨æ”å½±æ©Ÿç§»å‹•è§€å¯Ÿåœ°åœ–

### å‹åˆ©æ¢ä»¶
1. âœ… æ“Šæ®ºç›®æ¨™ï¼ˆTargetï¼‰
2. âœ… è¿”å›ç©å®¶å‡ºç”Ÿé»

### æŠ€è¡“æ£§
- **å¼•æ“**ï¼šUnity 2D
- **èªè¨€**ï¼šC#
- **è¼¸å…¥ç³»çµ±**ï¼šUnity Input System
- **æ¶æ§‹æ¨¡å¼**ï¼šçµ„ä»¶åŒ–æ¶æ§‹ + å–®ä¾‹ç®¡ç†å™¨æ¨¡å¼

---

## æ ¸å¿ƒæ¶æ§‹è¨­è¨ˆ

### è¨­è¨ˆåŸå‰‡

1. **æ¨¡çµ„åŒ–çµ„ä»¶è¨­è¨ˆ**
   - æ‰€æœ‰å¯¦é«”ï¼ˆç©å®¶ã€æ•µäººã€ç›®æ¨™ï¼‰ä½¿ç”¨çµ±ä¸€çš„çµ„ä»¶æ¶æ§‹
   - åŠŸèƒ½æ‹†åˆ†ç‚ºç¨ç«‹çµ„ä»¶ï¼šMovementã€Detectionã€Stateã€Visualizer

2. **ç¹¼æ‰¿ + çµ„åˆæ¨¡å¼**
   - æŠ½è±¡åŸºé¡å®šç¾©çµ±ä¸€ä»‹é¢
   - å…·é«”å¯¦ç¾é¡ç¹¼æ‰¿åŸºé¡ä¸¦å¯¦ç¾ç‰¹å®šåŠŸèƒ½
   - ä½¿ç”¨çµ„åˆæ¨¡å¼æ•´åˆå¤šå€‹çµ„ä»¶

3. **æ³›å‹è¨­è¨ˆ**
   - ç‹€æ…‹æ©Ÿä½¿ç”¨æ³›å‹æ”¯æ´ä»»æ„æšèˆ‰é¡å‹
   - æé«˜ä»£ç¢¼é‡ç”¨æ€§å’Œå‹åˆ¥å®‰å…¨æ€§

4. **äº‹ä»¶é©…å‹•**
   - çµ„ä»¶é–“é€éäº‹ä»¶é€šè¨Šï¼Œé™ä½è€¦åˆ
   - æ”¯æ´ UI å’ŒéŠæˆ²é‚è¼¯çš„åˆ†é›¢

### æ¶æ§‹å±¤ç´š

```
å±•ç¤ºå±¤ï¼ˆUI Layerï¼‰
    â†•
éŠæˆ²é‚è¼¯å±¤ï¼ˆGame Logic Layerï¼‰
    â†•
å¯¦é«”çµ„ä»¶å±¤ï¼ˆEntity Component Layerï¼‰
    â†•
åŸºç¤ç³»çµ±å±¤ï¼ˆBase System Layerï¼‰
    â†•
Unity å¼•æ“å±¤ï¼ˆUnity Engine Layerï¼‰
```

---

## å¯¦é«”ç³»çµ±

### æ¶æ§‹åœ–

```
BaseEntity<TState> (æŠ½è±¡åŸºé¡ - 248è¡Œ)
â”œâ”€â”€ BaseStateMachine<TState> (æ³›å‹ç‹€æ…‹æ©Ÿ)
â”‚   â”œâ”€â”€ PlayerStateMachine : BaseStateMachine<PlayerState>
â”‚   â”œâ”€â”€ EnemyStateMachine : BaseStateMachine<EnemyState>
â”‚   â””â”€â”€ (Target ç›´æ¥ä½¿ç”¨ EnemyStateMachine)
â”‚
â”œâ”€â”€ BaseMovement (ç§»å‹•åŸºé¡)
â”‚   â”œâ”€â”€ PlayerMovement : BaseMovement (297è¡Œ)
â”‚   â”œâ”€â”€ EnemyMovement : BaseMovement (604è¡Œ)
â”‚   â””â”€â”€ (Target ç›´æ¥ä½¿ç”¨ EnemyMovement)
â”‚
â”œâ”€â”€ BaseDetection (åµæ¸¬åŸºé¡)
â”‚   â”œâ”€â”€ PlayerDetection : BaseDetection
â”‚   â”œâ”€â”€ EnemyDetection : BaseDetection (295è¡Œ)
â”‚   â””â”€â”€ (Target ç›´æ¥ä½¿ç”¨ EnemyDetection)
â”‚
â”œâ”€â”€ BaseVisualizer (è¦–è¦ºåŒ–åŸºé¡)
â”‚   â”œâ”€â”€ PlayerVisualizer : BaseVisualizer
â”‚   â”œâ”€â”€ EnemyVisualizer : BaseVisualizer (103è¡Œ)
â”‚   â””â”€â”€ (Target ç›´æ¥ä½¿ç”¨ EnemyVisualizer)
â”‚
â””â”€â”€ ItemHolder (ç‰©å“ç®¡ç†çµ„ä»¶ - å…±ç”¨)
    â””â”€â”€ ç®¡ç†æ­¦å™¨ã€ç‰©å“çš„è£å‚™å’Œåˆ‡æ›
```

### BaseEntity æ ¸å¿ƒåŠŸèƒ½

**è·è²¬**ï¼š
- æ•´åˆæ‰€æœ‰æ ¸å¿ƒçµ„ä»¶çš„å¼•ç”¨
- æä¾›çµ±ä¸€çš„ç”Ÿå‘½é€±æœŸç®¡ç†
- å®šç¾©å…±ç”¨çš„å…¬å…±ä»‹é¢
- è™•ç†å¯¦é«”æ­»äº¡å’Œç‰©å“æ‰è½

**æ ¸å¿ƒå±¬æ€§**ï¼š
```csharp
protected BaseStateMachine<TState> stateMachine;
protected BaseMovement movement;
protected BaseDetection detection;
protected BaseVisualizer visualizer;
protected ItemHolder itemHolder;
```

**æ ¸å¿ƒæ–¹æ³•**ï¼š
- `InitializeEntity()` - åˆå§‹åŒ–å¯¦é«”ï¼ˆæŠ½è±¡æ–¹æ³•ï¼‰
- `UpdateEntity()` - æ›´æ–°é‚è¼¯ï¼ˆè™›æ“¬æ–¹æ³•ï¼‰
- `Die()` - æ­»äº¡è™•ç†
- `DropAllItems()` - æ‰è½æ‰€æœ‰ç‰©å“
- `SetTarget()` / `GetTarget()` - ç›®æ¨™ç®¡ç†
- `CanSeeTarget()` - è¦–é‡æª¢æ¸¬

### å…·é«”å¯¦é«”é¡åˆ¥

#### Playerï¼ˆç©å®¶ï¼‰
- **æª”æ¡ˆ**ï¼š`Player/Player.cs` (816è¡Œ)
- **ç‹€æ…‹**ï¼šIdle, Moving, Attacking, Dead
- **ç‰¹æ€§**ï¼š
  - éµç›¤/æ»‘é¼ è¼¸å…¥æ§åˆ¶
  - é»æ“Šç§»å‹•
  - è¡€é‡ç®¡ç†ï¼ˆé¡è‰²è®ŠåŒ–ï¼‰
  - æ­¦å™¨ç„æº–å’Œæ”»æ“Š
  - ç‰©å“æ’¿å–
  - é–€çš„é–‹å•Ÿ
  - å‹åˆ©æ¢ä»¶æª¢æŸ¥

#### Enemyï¼ˆæ•µäººï¼‰
- **æª”æ¡ˆ**ï¼š`Enemy/Enemy.cs` (960è¡Œ)
- **ç‹€æ…‹**ï¼šPatrol, Alert, Chase, Search, Return, Dead
- **ç‰¹æ€§**ï¼š
  - å®Œæ•´çš„ AI ç‹€æ…‹æ©Ÿ
  - å·¡é‚è·¯å¾‘ç³»çµ±
  - **æ™ºèƒ½è¿½æ“Šç³»çµ±ï¼ˆv2.1ï¼‰**
    - ç›´ç·šè¿½æ“Šå„ªå…ˆï¼ˆç„¡éšœç¤™æ™‚ï¼‰
    - è·¯å¾‘è¦åŠƒå‚™ç”¨ï¼ˆæœ‰éšœç¤™æ™‚ï¼‰
    - åŸºæ–¼è·é›¢çš„å‹•æ…‹è·¯å¾‘æ›´æ–°
  - è·¯å¾‘è¦åŠƒï¼ˆæ”¹é€²çš„è²ªå©ªç®—æ³•ï¼‰
  - è¦–é‡åµæ¸¬å’Œæ”»æ“Š
  - è¡€é‡ç®¡ç†
  - è¦–è¦ºåŒ–æ§åˆ¶ï¼ˆç”± EnemyManager ç®¡ç†ï¼‰

#### Targetï¼ˆç›®æ¨™ï¼‰
- **å¯¦ä½œæ–¹å¼**ï¼šç›´æ¥ä½¿ç”¨ Enemy çµ„ä»¶
- **åŸå› **ï¼šTarget èˆ‡ Enemy é‚è¼¯å®Œå…¨ç›¸åŒï¼Œç„¡éœ€é‡è¤‡å¯¦ä½œ
- **å€åˆ¥**ï¼šé€éé…ç½®åƒæ•¸ï¼ˆåç¨±ã€å¤–è§€ï¼‰å€åˆ†

---

## æ•µäººAIç³»çµ±

### ç‹€æ…‹æ©Ÿæ¶æ§‹

#### ç‹€æ…‹å®šç¾©

```csharp
public enum EnemyState
{
    Patrol,   // å·¡é‚
    Alert,    // è­¦æˆ’
    Chase,    // è¿½æ“Š
    Search,   // æœç´¢
    Return,   // è¿”å›
    Dead      // æ­»äº¡
}
```

#### ç‹€æ…‹è½‰æ›é‚è¼¯

```
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”Œâ”€â”€â”€â†’â”‚ Patrol  â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
    â”‚         â”‚                â”‚
    â”‚    çœ‹åˆ°ç©å®¶              â”‚
    â”‚         â†“                â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
    â”‚    â”‚  Alert  â”‚           â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
    â”‚         â”‚                â”‚
    â”‚    è­¦æˆ’æ™‚é–“åˆ°            â”‚
    â”‚         â†“                â”‚
è¶…å‡º  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      åˆ°é”èµ·é»
ç¯„åœ  â”‚    â”‚  Chase  â”‚           â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
    â”‚         â”‚                â”‚
    â”‚    å¤±å»è¦–ç·š              â”‚
    â”‚         â†“                â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
    â”‚    â”‚ Search  â”‚           â”‚
    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
    â”‚         â”‚                â”‚
    â”‚    æœç´¢è¶…æ™‚/è¶…å‡ºç¯„åœ     â”‚
    â”‚         â†“                â”‚
    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
    â””â”€â”€â”€â”€â”‚ Return  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å„ç‹€æ…‹è©³ç´°èªªæ˜

#### 1. Patrolï¼ˆå·¡é‚ï¼‰
- **è¡Œç‚º**ï¼šæ²¿è‘—é è¨­çš„å·¡é‚è·¯å¾‘ç§»å‹•
- **è½‰æ›**ï¼šçœ‹åˆ°ç©å®¶ â†’ Alert
- **ç‰¹æ€§**ï¼š
  - è¦–é‡æ–¹å‘è·Ÿéš¨ç§»å‹•æ–¹å‘
  - åˆ°é”å·¡é‚é»å¾Œå‰å¾€ä¸‹ä¸€å€‹é»
  - å¾ªç’°å·¡é‚

#### 2. Alertï¼ˆè­¦æˆ’ï¼‰
- **è¡Œç‚º**ï¼šç™¼ç¾ç•°å¸¸ä½†é‚„æ²’çœ‹åˆ°ç©å®¶ï¼Œæé«˜è­¦è¦º
- **è½‰æ›**ï¼š
  - çœ‹åˆ°ç©å®¶ â†’ Chase
  - è­¦æˆ’æ™‚é–“åˆ° â†’ Patrol
- **è¨ˆæ™‚å™¨**ï¼š`alertTime` åƒæ•¸æ§åˆ¶è­¦æˆ’æŒçºŒæ™‚é–“

#### 3. Chaseï¼ˆè¿½æ“Šï¼‰
- **è¡Œç‚º**ï¼šè¿½è¶•ç©å®¶ä¸¦å˜—è©¦æ”»æ“Š
- **è½‰æ›**ï¼š
  - å¤±å»è¦–ç·š â†’ Search
  - è¶…å‡ºè¿½æ“Šç¯„åœ â†’ Return
  - å¡ä½ â†’ Search
- **ç‰¹æ€§**ï¼š
  - **æ™ºèƒ½è¿½æ“Šç³»çµ±**ï¼ˆv2.1 æ–°å¢ï¼‰
    - å„ªå…ˆä½¿ç”¨ç›´ç·šè¿½æ“Šï¼ˆæ¯ 0.1 ç§’æª¢æ¸¬ä¸€æ¬¡éšœç¤™ç‰©ï¼‰
    - æœ‰éšœç¤™ç‰©æ™‚è‡ªå‹•åˆ‡æ›è·¯å¾‘è¦åŠƒ
    - å¤§å¹…æå‡è¿½æ“Šæµæš¢åº¦å’Œæ€§èƒ½
  - è¨˜éŒ„ç©å®¶æœ€å¾Œä½ç½®
  - åœ¨æ”»æ“Šç¯„åœå…§å˜—è©¦æ”»æ“Š
  - æ­¦å™¨æœå‘ç©å®¶
  - **ç§»å‹•åŸ·è¡Œæ¯å¹€æ›´æ–°**ï¼Œç¢ºä¿æµæš¢è¿½æ“Š

#### 4. Searchï¼ˆæœç´¢ï¼‰
- **è¡Œç‚º**ï¼šå‰å¾€ç©å®¶æœ€å¾Œå‡ºç¾çš„ä½ç½®æœç´¢
- **è½‰æ›**ï¼š
  - é‡æ–°çœ‹åˆ°ç©å®¶ â†’ Chase
  - æœç´¢è¶…æ™‚ â†’ Alert
  - è¶…å‡ºè¿½æ“Šç¯„åœ â†’ Return
- **ç‰¹æ€§**ï¼š
  - ä½¿ç”¨è·¯å¾‘è¦åŠƒå‰å¾€ç›®æ¨™ä½ç½®
  - åˆ°é”å¾Œé–‹å§‹è¨ˆæ™‚
  - å¯ä»¥åœ¨æœç´¢éç¨‹ä¸­é‡æ–°ç™¼ç¾ç©å®¶

#### 5. Returnï¼ˆè¿”å›ï¼‰
- **è¡Œç‚º**ï¼šè¿”å›å·¡é‚èµ·é»ï¼ˆç¬¬ä¸€å€‹å·¡é‚é»ï¼‰
- **è½‰æ›**ï¼šåˆ°é”èµ·é» â†’ Patrol
- **ç‰¹æ€§**ï¼š
  - ä½¿ç”¨è·¯å¾‘è¦åŠƒè¿”å›
  - é‡ç½®å·¡é‚ç´¢å¼•

#### 6. Deadï¼ˆæ­»äº¡ï¼‰
- **è¡Œç‚º**ï¼šåœæ­¢æ‰€æœ‰è¡Œç‚ºï¼Œç¦ç”¨ç‰©ä»¶
- **ç‰¹æ€§**ï¼š
  - æ‰è½æ‰€æœ‰ç‰©å“
  - é€šçŸ¥ GameManager

### è·¯å¾‘è¦åŠƒç³»çµ±

#### GreedyPathfinding
- **æª”æ¡ˆ**ï¼š`Enemy/Pathfinding/GreedyPathfinding.cs`
- **ç®—æ³•**ï¼šè²ªå©ªæœ€ä½³å„ªå…ˆæœç´¢ï¼ˆé¡ä¼¼ A*ï¼‰
- **ç‰¹æ€§**ï¼š
  - ä½¿ç”¨ç¶²æ ¼ç³»çµ±
  - æ”¯æ´éšœç¤™ç‰©é¿è®“
  - å‹•æ…‹è·¯å¾‘æ›´æ–°

#### æ™ºèƒ½è¿½æ“Šç³»çµ±ï¼ˆv2.1ï¼‰

**ç›´ç·šè¿½æ“Šå„ªå…ˆç­–ç•¥**ï¼š
```csharp
// æ¯ 0.1 ç§’æª¢æ¸¬æ˜¯å¦èƒ½ç›´ç·šåˆ°é”
if (CanReachDirectly(target))
    ChaseTargetDirect(target);  // ç›´ç·šè¿½æ“Š
else
    UsePathfinding(target);     // è·¯å¾‘è¦åŠƒ
```

**å„ªå‹¢**ï¼š
- ç›´ç·šè¿½æ“Šæ™‚ç„¡éœ€è¨ˆç®—è·¯å¾‘ï¼ŒCPU è² è¼‰æ¥µä½
- è¿‘è·é›¢è¿½æ“Šåæ‡‰éˆæ•ï¼Œä¸æœƒè¡éé ­
- è‡ªå‹•åˆ‡æ›ï¼Œç„¡éœ€æ‰‹å‹•åˆ¤æ–·

#### åŸºæ–¼è·é›¢çš„è·¯å¾‘æ›´æ–°ï¼ˆv2.1ï¼‰

**æ›´æ–°è§¸ç™¼æ¢ä»¶**ï¼š
1. è·¯å¾‘ç‚ºç©ºæˆ–åˆ°é”çµ‚é»
2. ç›®æ¨™ä½ç½®è®ŠåŒ– > 0.5 å–®ä½
3. æ•µäººç§»å‹•è·é›¢è¶…éé–¾å€¼ï¼š
   - å·¡é‚/è¿”å›ï¼š2 å–®ä½
   - è¿½æ“Šï¼š1 å–®ä½

**å„ªå‹¢**ï¼š
- éœæ­¢æ™‚ä¸æµªè²» CPU
- ç§»å‹•å¿«æ™‚æ›´æ–°é »ç¹ï¼ˆæ›´æº–ç¢ºï¼‰
- ç§»å‹•æ…¢æ™‚æ›´æ–°æ¸›å°‘ï¼ˆç¯€çœè³‡æºï¼‰

#### è‡ªå‹•ä½ç½®èª¿æ•´ï¼ˆv2.1ï¼‰

**å•é¡Œ**ï¼šç©å®¶è²¼ç‰†æˆ–æ•µäººä½ç½®è¢«åˆ¤å®šç‚ºä¸å¯è¡Œèµ°

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
- è‡ªå‹•æœç´¢æœ€è¿‘çš„å¯è¡Œèµ°ç¯€é»ï¼ˆ3 å–®ä½å…§ï¼‰
- èµ·é»èª¿æ•´ï¼š2 å–®ä½æœç´¢åŠå¾‘
- çµ‚é»èª¿æ•´ï¼š3 å–®ä½æœç´¢åŠå¾‘
- ç¢ºä¿è·¯å¾‘è¦åŠƒç¸½èƒ½æˆåŠŸ

#### å¡ä½æª¢æ¸¬

**æ™ºèƒ½åˆ¤å®š**ï¼š
- ç›´ç·šè¿½æ“Šæ™‚ï¼šé€Ÿåº¦ç‚ºé›¶è¶…é 1 ç§’æ‰åˆ¤å®šå¡ä½
- è·¯å¾‘è¦åŠƒæ™‚ï¼šé€Ÿåº¦ç‚ºé›¶è¶…é 0.5 ç§’åˆ¤å®šå¡ä½
- ä½ç½®å¹¾ä¹ä¸è®Šä¸”æŒçºŒ 0.5 ç§’
- è‡ªå‹•å¾ Chase åˆ‡æ›åˆ° Search ç‹€æ…‹

### æ€§èƒ½å„ªåŒ–

#### AI æ±ºç­–èˆ‡ç§»å‹•åˆ†é›¢ï¼ˆv2.1ï¼‰

**é›™é »ç‡æ›´æ–°æ©Ÿåˆ¶**ï¼š
```csharp
// AI æ±ºç­–ï¼šæ¯ 0.15 ç§’æ›´æ–°ä¸€æ¬¡ï¼ˆä½é »ï¼‰
if (Time.time - lastAIUpdateTime >= aiUpdateInterval)
{
    UpdateAIDecision();  // ç‹€æ…‹åˆ¤æ–·ã€ç›®æ¨™é¸æ“‡
}

// ç§»å‹•åŸ·è¡Œï¼šæ¯å¹€æ›´æ–°ï¼ˆé«˜é »ï¼‰
ExecuteMovement();  // æŒçºŒåŸ·è¡Œç§»å‹•å‘½ä»¤
```

**å„ªå‹¢**ï¼š
- AI æ±ºç­–ä½é »æ›´æ–°ï¼Œç¯€çœ CPU
- ç§»å‹•åŸ·è¡Œé«˜é »æ›´æ–°ï¼Œç¢ºä¿æµæš¢
- é¿å…ã€Œè¨­ç½®é€Ÿåº¦å¾Œç«‹å³åœæ­¢ã€çš„å•é¡Œ

#### æ™ºèƒ½è·¯å¾‘æ›´æ–°ï¼ˆv2.1ï¼‰

**å¾å›ºå®šæ™‚é–“æ”¹ç‚ºå›ºå®šè·é›¢**ï¼š
```csharp
// ä¿®æ”¹å‰ï¼šæ¯ 0.2 ç§’æ›´æ–°è·¯å¾‘
// ä¿®æ”¹å¾Œï¼šç§»å‹• 1 å–®ä½å¾Œæ›´æ–°è·¯å¾‘ï¼ˆè¿½æ“Šæ™‚ï¼‰
```

**æ•ˆæœ**ï¼š
- éœæ­¢æˆ–æ…¢é€Ÿç§»å‹•æ™‚ä¸æµªè²»è¨ˆç®—
- å¿«é€Ÿç§»å‹•æ™‚è‡ªå‹•æ›´æ–°æ›´é »ç¹
- æ ¹æ“šå¯¦éš›éœ€æ±‚å‹•æ…‹èª¿æ•´

#### æ•¸æ“šå¿«å–
```csharp
private Vector2 cachedPosition;
private Vector2 cachedDirectionToPlayer;
private bool cachedCanSeePlayer;
private const float CACHE_UPDATE_INTERVAL = 0.1f;
```
- æ¸›å°‘é‡è¤‡è¨ˆç®—
- é™ä½ GC å£“åŠ›

#### éŒ¯é–‹æ›´æ–°æ™‚é–“
- å¯ç”± EnemyManager èª¿æ•´å„æ•µäººçš„æ›´æ–°æ™‚é–“
- éŒ¯é–‹å„æ•µäººçš„æ›´æ–°æ™‚é–“ï¼Œå¹³è¡¡è² è¼‰

---

## æ­¦å™¨èˆ‡ç‰©å“ç³»çµ±

### é¡åˆ¥ç¹¼æ‰¿æ¶æ§‹

```
Item (æŠ½è±¡åŸºé¡)
â”œâ”€â”€ å±¬æ€§: itemName, itemIcon
â”œâ”€â”€ æ–¹æ³•: OnEquip(), OnUnequip(), UpdateDirection()
â”‚
â””â”€â”€ Weapon (æŠ½è±¡æ­¦å™¨åŸºé¡)
    â”œâ”€â”€ å±¬æ€§: attackCooldown, maxDurability, attackDamage
    â”œâ”€â”€ æ–¹æ³•: CanAttack(), TryPerformAttack(), ReduceDurability()
    â”œâ”€â”€ äº‹ä»¶: OnAttackPerformed, OnDurabilityChanged, OnWeaponBroken
    â”‚
    â”œâ”€â”€ MeleeWeapon (è¿‘æˆ°æ­¦å™¨åŸºé¡)
    â”‚   â”œâ”€â”€ å±¬æ€§: attackRange, attackAngle
    â”‚   â”œâ”€â”€ å¯¦ä½œ: PerformAttack() - ç¯„åœæ”»æ“Š
    â”‚   â”‚
    â”‚   â””â”€â”€ Knife (å°åˆ€)
    â”‚       â””â”€â”€ ç‰¹æ€§: ç„¡é™è€ä¹…åº¦
    â”‚
    â””â”€â”€ RangedWeapon (é ç¨‹æ­¦å™¨åŸºé¡)
        â”œâ”€â”€ å±¬æ€§: attackRange, bulletSpeed, bulletDamage
        â”œâ”€â”€ å¯¦ä½œ: PerformAttack() - ç™¼å°„å­å½ˆ
        â”‚
        â””â”€â”€ Gun (æ§)
            â”œâ”€â”€ ä»‹é¢: IAmmoWeapon
            â””â”€â”€ ç‰¹æ€§: å­å½ˆæœ‰é™ï¼Œè€ä¹…åº¦æœ‰é™
```

### ItemHolderï¼ˆç‰©å“ç®¡ç†å™¨ï¼‰

**æª”æ¡ˆ**ï¼š`Item/ItemHolder.cs` (731è¡Œ)

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. **å¤šç‰©å“ç®¡ç†**
   - æ”¯æ´å¤šå€‹ç‰©å“åŒæ™‚æŒæœ‰
   - åˆ‡æ›ç•¶å‰è£å‚™çš„ç‰©å“
   - è¨˜éŒ„æ¯å€‹ç‰©å“å°æ‡‰çš„ Prefab

2. **è£å‚™ç³»çµ±**
   ```csharp
   public void SetItem(Item item)
   public Item EquipFromPrefab(GameObject prefab)
   public bool SwitchToNextItem()
   public bool SwitchToPreviousItem()
   ```

3. **æ”»æ“Šç³»çµ±**
   ```csharp
   public bool TryAttack(GameObject attacker)
   public bool CanAttack()
   ```
   - åªæœ‰æ­¦å™¨æ‰èƒ½æ”»æ“Š
   - æª¢æŸ¥å†·å»æ™‚é–“
   - è§¸ç™¼æ”»æ“Šå‹•ç•«

4. **è€ä¹…åº¦ç®¡ç†**
   - ç›£è½æ­¦å™¨è€ä¹…åº¦äº‹ä»¶
   - æ­¦å™¨ç ´æè‡ªå‹•åˆ‡æ›
   - è§¸ç™¼ UI æ›´æ–°

5. **ç‰©å“è¿½è¹¤**
   ```csharp
   private Dictionary<Item, GameObject> itemToPrefabMap
   public List<KeyValuePair<Item, GameObject>> GetAllItemsWithPrefabs()
   ```
   - è¨˜éŒ„ç‰©å“å°æ‡‰çš„åŸå§‹ Prefab
   - ç”¨æ–¼æ­»äº¡æ™‚é‡æ–°ç”Ÿæˆç‰©å“

### æ­¦å™¨è€ä¹…åº¦ç³»çµ±

#### è€ä¹…åº¦æ©Ÿåˆ¶
- æ¯æ¬¡æ”»æ“Šæ¶ˆè€— 1 é»è€ä¹…åº¦
- è€ä¹…åº¦æ­¸é›¶æ™‚æ­¦å™¨ç ´æ
- å°åˆ€ï¼šç„¡é™è€ä¹…åº¦ï¼ˆè¨­å®šç‚ºæ¥µå¤§å€¼ï¼‰
- æ§ï¼šæœ‰é™è€ä¹…åº¦

#### äº‹ä»¶ç³»çµ±
```csharp
public event Action<int, int> OnDurabilityChanged;
public event Action OnWeaponBroken;
```

### ç‰©å“æ‰è½èˆ‡æ’¿å–

#### ItemManager
**æª”æ¡ˆ**ï¼š`Game/ItemManager.cs` (646è¡Œ)

**åŠŸèƒ½**ï¼š
1. **ç‰©å“ç”Ÿæˆ**
   - å¾ `itemdata.txt` è®€å–ç‰©å“ä½ç½®
   - ç”Ÿæˆ WorldItem åˆ°å ´æ™¯ä¸­
   - ç¶­è­·ç‰©å“åˆ—è¡¨

2. **ç‰©å“æ’¿å–**
   ```csharp
   public bool TryPickupItem(Vector3 position, ItemHolder holder, float range)
   public bool TryPickupItemByType(string itemType, ...)
   ```
   - ç¯„åœæª¢æ¸¬ï¼ˆé è¨­ 2 æ ¼ï¼‰
   - è‡ªå‹•æ‰¾æœ€è¿‘çš„ç‰©å“
   - åŠ å…¥åˆ° ItemHolder

3. **ç‰©å“æ‰è½**
   ```csharp
   public WorldItem DropItemAtPosition(GameObject prefab, Vector3 position)
   public List<WorldItem> DropItemsAtPosition(List<GameObject> prefabs, Vector3 position, float radius)
   ```
   - å¯¦é«”æ­»äº¡æ™‚èª¿ç”¨
   - åœ“å½¢æ•£è½ï¼ˆåŠå¾‘ 1.5 æ ¼ï¼‰
   - é‡æ–°åŠ å…¥å ´æ™¯ç®¡ç†

#### WorldItem
**æª”æ¡ˆ**ï¼š`Item/WorldItem.cs`

**åŠŸèƒ½**ï¼š
- è¡¨ç¤ºå ´æ™¯ä¸­æ•£è½çš„ç‰©å“
- é¡¯ç¤ºç‰©å“åœ–ç¤ºå’Œåç¨±
- å¯è¢«æ’¿å–

#### æ‰è½æµç¨‹

```
Entity.Die()
    â†“
BaseEntity.DropAllItems()
    â†“
ItemManager.DropItemsAtPosition()
    â†“
ç”Ÿæˆ WorldItem (åœ“å½¢æ•£è½)
    â†“
Player é è¿‘ä¸¦æŒ‰ E
    â†“
ItemManager.TryPickupItem()
    â†“
ItemHolder.AddItemFromPrefab()
```

---

## å±éšªä¿‚æ•¸ç³»çµ±

### DangerousManager

**æª”æ¡ˆ**ï¼š`Dangerous/DangerousManager.cs` (397è¡Œ)

**è¨­è¨ˆç›®çš„**ï¼š
- æä¾›éš±æ€§çš„å±éšªåé¥‹çµ¦ç©å®¶
- é¿å…ç›´æ¥é¡¯ç¤ºæ•µäººæ˜¯å¦çœ‹åˆ°ç©å®¶
- å¢åŠ éŠæˆ²ç·Šå¼µæ„Ÿå’Œæ²‰æµ¸æ„Ÿ

### å±éšªå€¼è¨ˆç®—è¦å‰‡

#### è¦å‰‡ç¸½è¦½
```
è¦–é‡å…§ï¼šç«‹å³ 100
è¦–é‡å¤–ï¼š
  â”œâ”€ 5 æ ¼ä»¥å…§ï¼šæ¯ç§’ +20
  â”œâ”€ 5~10 æ ¼ï¼šä¸è®Š
  â””â”€ 10 æ ¼ä»¥ä¸Šï¼šæ¯ç§’ -20
```

#### å¯¦ä½œæ©Ÿåˆ¶

**èšåˆç³»çµ±**ï¼š
```csharp
public void ReportEnemyPerception(float distance, bool canSee)
```
- æ¯å€‹æ•µäººæ¯å¹€å›å ±ç‹€æ…‹
- DangerousManager èšåˆæ‰€æœ‰æ•µäººçš„è³‡è¨Š
- ä½¿ç”¨æœ€è¿‘è·é›¢å’Œæ˜¯å¦è¢«ä»»ä¸€æ•µäººçœ‹åˆ°

**æ›´æ–°é‚è¼¯**ï¼š
```csharp
private void ApplyAggregatedPerception(float deltaTime)
```
- æ¯å¹€æ ¹æ“šèšåˆè³‡è¨Šæ›´æ–°å±éšªå€¼
- ä½¿ç”¨æµ®é»ç´¯åŠ å™¨é¿å…æŠ–å‹•
- é”åˆ°é–¾å€¼æ™‚è½‰æ›ç‚ºæ•´æ•¸å¢æ¸›

### å±éšªç­‰ç´š

```csharp
public enum DangerLevel
{
    Safe,       // å®‰å…¨ (0-30) ğŸŸ¢
    Low,        // ä½å±éšª (31-60) ğŸŸ¡
    Medium,     // ä¸­ç­‰å±éšª (61-80) ğŸŸ 
    High,       // é«˜å±éšª (81-100) ğŸ”´
    Critical    // æ¥µåº¦å±éšª (100) ğŸŸ£
}
```

### äº‹ä»¶ç³»çµ±

```csharp
public event Action<int, int> OnDangerLevelChanged;
public event Action<DangerLevel> OnDangerLevelTypeChanged;
public event Action OnDangerLevelReachedMax;
public event Action OnDangerLevelReachedMin;
```

### UI æ•´åˆ

**DangerousUI**ï¼š
- é¡¯ç¤ºå±éšªæ¢ï¼ˆé€²åº¦æ¢ï¼‰
- æ ¹æ“šå±éšªç­‰ç´šæ”¹è®Šé¡è‰²
- å¯é¸é¡¯ç¤ºæ•¸å€¼å’Œæ–‡å­—

---

## æ”å½±æ©Ÿç³»çµ±

### CameraController2D

**æª”æ¡ˆ**ï¼š`Camera/CameraController2D.cs` (303è¡Œ)

### é›™æ¨¡å¼è¨­è¨ˆ

#### æ­£å¸¸æ¨¡å¼ï¼ˆè·Ÿéš¨ç©å®¶ï¼‰
- æ”å½±æ©Ÿå¹³æ»‘è·Ÿéš¨ç©å®¶ä½ç½®
- æ”¯æ´é‚Šç·£é™åˆ¶
- ç©å®¶å¯ä»¥è‡ªç”±ç§»å‹•

#### æ”å½±æ©Ÿç§»å‹•æ¨¡å¼ï¼ˆæŒ‰ä½ Spaceï¼‰
- ç©å®¶ç„¡æ³•ç§»å‹•
- WASD æ§åˆ¶æ”å½±æ©Ÿç§»å‹•
- å¯ä»¥è§€å¯Ÿåœ°åœ–å’Œæ•µäºº
- é‡‹æ”¾ Space å¾Œä¸å†è·Ÿéš¨ç©å®¶

### é‚Šç·£é™åˆ¶ç³»çµ±

**ç›®çš„**ï¼šç¢ºä¿ç©å®¶å§‹çµ‚åœ¨å¯è¦–ç¯„åœå…§

**åƒæ•¸**ï¼š
```csharp
public float normalEdgeDistance = 1f;    // å¹³å¸¸ï¼šé›¢é‚Šç·£è‡³å°‘ 1 æ ¼
public float alertEdgeDistance = 3f;     // è­¦æˆ’ï¼šé›¢é‚Šç·£è‡³å°‘ 3 æ ¼ï¼ˆè¨ˆåŠƒä¸­ï¼‰
```

**å¯¦ä½œ**ï¼š
- è¨ˆç®—æ”å½±æ©Ÿè¦–å£é‚Šç•Œ
- è¨ˆç®—ç©å®¶è·é›¢å„é‚Šç·£çš„è·é›¢
- ç•¶ç©å®¶æ¥è¿‘é‚Šç·£æ™‚ï¼Œæ”å½±æ©Ÿè‡ªå‹•èª¿æ•´
- ç©å®¶ç§»å‹•ä¹Ÿå—é™æ–¼é‚Šç·£è·é›¢ï¼ˆPlayerMovementï¼‰

### æ”å½±æ©Ÿç§»å‹•é™åˆ¶

**é›™å‘é™åˆ¶**ï¼š
1. ç©å®¶ç§»å‹•å—é™ï¼ˆPlayerMovement.ApplyEdgeLimitsï¼‰
2. æ”å½±æ©Ÿç§»å‹•å—é™ï¼ˆCameraController2D.ApplyCameraEdgeLimitsï¼‰

**è¨­è¨ˆç›®çš„**ï¼š
- é˜²æ­¢ç©å®¶è¶…å‡ºè¦–é‡
- å¢åŠ éŠæˆ²ç­–ç•¥æ€§
- é…åˆé¡é ­ç§»å‹•æ©Ÿåˆ¶

### éŠæˆ²è¨­è¨ˆæ„ç¾©

**é¡é ­è·¯å¾‘ä½œç‚ºç­–ç•¥å…ƒç´ **ï¼ˆè¨ˆåŠƒä¸­ï¼‰ï¼š
- æŸäº›å€åŸŸå¿…é ˆç§»å‹•é¡é ­æ‰èƒ½çœ‹åˆ°
- æœ€ä½³è·¯ç·šå¯èƒ½æ ¹æœ¬ä¸éœ€è¦çœ‹åˆ°æ•µäºº
- å¢åŠ é—œå¡è¨­è¨ˆæ·±åº¦

---

## éŠæˆ²ç®¡ç†ç³»çµ±

### GameManagerï¼ˆéŠæˆ²ç¸½æ§åˆ¶å™¨ï¼‰

**æª”æ¡ˆ**ï¼š`GameManager.cs` (503è¡Œ)

**æ¨¡å¼**ï¼šå–®ä¾‹æ¨¡å¼

#### éŠæˆ²ç‹€æ…‹ç®¡ç†

```csharp
public enum GameState
{
    MainMenu,   // ä¸»é¸å–®
    Playing,    // éŠç©ä¸­
    Paused,     // æš«åœ
    GameOver    // éŠæˆ²çµæŸ
}
```

#### æ ¸å¿ƒåŠŸèƒ½

1. **å ´æ™¯ç®¡ç†**
   ```csharp
   public void StartNewGame()
   public void RestartGame()
   public void ReturnToMainMenu()
   public void QuitGame()
   ```

2. **ç³»çµ±å¼•ç”¨ç®¡ç†**
   ```csharp
   private PlayerManager playerManager;
   private EnemyManager enemyManager;
   ```
   - å ´æ™¯è¼‰å…¥æ™‚è‡ªå‹•å°‹æ‰¾ç³»çµ±
   - é›¢é–‹å ´æ™¯æ™‚æ¸…ç†å¼•ç”¨

3. **äº‹ä»¶ç›£è½**
   ```csharp
   player.OnPlayerDied += HandlePlayerDeath;
   player.OnPlayerWon += HandlePlayerWin;
   ```
   - ç›£è½ç©å®¶æ­»äº¡å’Œå‹åˆ©
   - è‡ªå‹•è™•ç†éŠæˆ²çµæŸæµç¨‹

4. **çµ±è¨ˆè³‡æ–™**
   ```csharp
   private int enemiesKilled;
   private float gameTime;
   private int currentWave;
   ```

5. **æš«åœç³»çµ±**
   ```csharp
   public void PauseGame()
   public void ResumeGame()
   public void TogglePause()
   ```
   - ESC éµè§¸ç™¼
   - ä½¿ç”¨ `Time.timeScale` æ§åˆ¶

### PlayerManager

**åŠŸèƒ½**ï¼š
- ç®¡ç†ç©å®¶å¼•ç”¨
- æä¾›å…¨å±€è¨ªå•é»

### EnemyManager

**æª”æ¡ˆ**ï¼š`Game/EnemyManager.cs`

**åŠŸèƒ½**ï¼š
1. **æ•µäººç”Ÿæˆ**
   - å¾ `patroldata.txt` è®€å–å·¡é‚è·¯å¾‘
   - ç”Ÿæˆæ•µäººåˆ°å ´æ™¯ä¸­
   - è¨­å®šå·¡é‚é»

2. **è¦–è¦ºåŒ–ç®¡ç†**
   ```csharp
   enemy.SetCanVisualize(canVisualize)
   ```
   - æ§åˆ¶æ•µäºº Gizmos é¡¯ç¤º
   - é¿å…éå¤šè¦–è¦ºåŒ–å½±éŸ¿æ€§èƒ½

3. **æ€§èƒ½å„ªåŒ–**
   - éŒ¯é–‹å„æ•µäººçš„ AI æ›´æ–°æ™‚é–“
   - æ‰¹æ¬¡è™•ç†æ•µäººæ›´æ–°

4. **äº‹ä»¶è™•ç†**
   - ç›£è½æ•µäººæ­»äº¡
   - é€šçŸ¥ GameManager

### SceneLoader

**æª”æ¡ˆ**ï¼š`SceneLoader.cs`

**åŠŸèƒ½**ï¼š
- å ´æ™¯åˆ‡æ›ç®¡ç†
- è¼‰å…¥é€²åº¦é¡¯ç¤º
- ç•°æ­¥è¼‰å…¥æ”¯æ´

---

## è³‡æ–™é©…å‹•è¨­è¨ˆ

### ç‚ºä»€éº¼ä½¿ç”¨æ–‡æœ¬æ–‡ä»¶ï¼Ÿ

**å„ªé»**ï¼š
1. âœ… æ˜“æ–¼ç·¨è¼¯ï¼ˆä¸éœ€è¦ Unity Editorï¼‰
2. âœ… ç‰ˆæœ¬æ§åˆ¶å‹å¥½ï¼ˆç´”æ–‡å­—ï¼‰
3. âœ… å¯ä»¥ç”¨å¤–éƒ¨å·¥å…·ç”Ÿæˆ
4. âœ… æ”¯æ´æ‰¹é‡è™•ç†
5. âœ… é—œå¡è¨­è¨ˆå¸«æ˜“æ–¼ç†è§£

### patroldata.txtï¼ˆæ•µäººå·¡é‚è·¯å¾‘ï¼‰

**æ ¼å¼**ï¼š
```
# EnemyIndex, LocationIndex, X, Y, Z
0, 0, -52.31531, -1.914664, 0
0, 1, -48.34058, -1.914664, 0
0, 2, -48.34058, -5.889395, 0
1, 0, -41.22803, 0.1848145, 0
1, 1, -41.22803, 4.159546, 0
```

**èªªæ˜**ï¼š
- `EnemyIndex`ï¼šæ•µäººç·¨è™Ÿï¼ˆå¾ 0 é–‹å§‹ï¼‰
- `LocationIndex`ï¼šå·¡é‚é»ç·¨è™Ÿï¼ˆå¾ 0 é–‹å§‹ï¼‰
- `X, Y, Z`ï¼šä¸–ç•Œåº§æ¨™

**è¼‰å…¥æµç¨‹**ï¼š
```
EnemyManager.Start()
    â†“
LoadPatrolData()
    â†“
ParsePatrolData()
    â†“
SpawnEnemy()
    â†“
Enemy.SetPatrolLocations()
```

### itemdata.txtï¼ˆç‰©å“ä½ç½®ï¼‰

**æ ¼å¼**ï¼š
```
# ItemIndex, ItemType, X, Y, Z
0, Gun, -41.80566, -1.914664, 0
1, Knife, -59.42783, -1.914664, 0
2, Gun, -48.91895, -5.312744, 0
```

**èªªæ˜**ï¼š
- `ItemIndex`ï¼šç‰©å“ç·¨è™Ÿ
- `ItemType`ï¼šç‰©å“é¡å‹ï¼ˆå¿…é ˆèˆ‡ Prefab æ˜ å°„è¡¨åŒ¹é…ï¼‰
- `X, Y, Z`ï¼šä¸–ç•Œåº§æ¨™

**Prefab æ˜ å°„**ï¼š
åœ¨ ItemManager Inspector ä¸­è¨­å®šï¼š
```
ItemPrefabMappings:
  - itemType: "Gun"
    itemPrefab: Gun Prefab
  - itemType: "Knife"
    itemPrefab: Knife Prefab
```

**è¼‰å…¥æµç¨‹**ï¼š
```
ItemManager.Start()
    â†“
LoadItemData()
    â†“
SpawnAllItems()
    â†“
SpawnItem()
    â†“
WorldItem ç”Ÿæˆåˆ°å ´æ™¯
```

---

## UIç³»çµ±

### æ¶æ§‹

```
GameUIManager (UI ç¸½æ§åˆ¶å™¨)
â”œâ”€â”€ PlayerHealthUI (ç©å®¶è¡€é‡)
â”œâ”€â”€ DangerousUI (å±éšªä¿‚æ•¸)
â”œâ”€â”€ ItemSlotUI (ç‰©å“æ¬„/å¿«æ·éµ)
â”œâ”€â”€ WeaponDurabilityUI (æ­¦å™¨è€ä¹…åº¦)
â”œâ”€â”€ PauseMenuUI (æš«åœé¸å–®)
â””â”€â”€ LoadingProgressUI (è¼‰å…¥é€²åº¦)
```

### GameUIManager

**åŠŸèƒ½**ï¼š
- çµ±ä¸€ç®¡ç†æ‰€æœ‰ UI çµ„ä»¶
- è¨‚é–±éŠæˆ²äº‹ä»¶
- æ›´æ–° UI é¡¯ç¤º

### PlayerHealthUI

**é¡¯ç¤º**ï¼š
- ç•¶å‰è¡€é‡ / æœ€å¤§è¡€é‡
- è¡€é‡æ¢ï¼ˆé€²åº¦æ¢ï¼‰
- æ ¹æ“šè¡€é‡ç™¾åˆ†æ¯”æ”¹è®Šé¡è‰²

**äº‹ä»¶è¨‚é–±**ï¼š
```csharp
player.OnHealthChanged += UpdateHealthUI;
```

### DangerousUI

**é¡¯ç¤º**ï¼š
- å±éšªä¿‚æ•¸å€¼ï¼ˆ0-100ï¼‰
- å±éšªæ¢ï¼ˆé€²åº¦æ¢ï¼‰
- æ ¹æ“šå±éšªç­‰ç´šæ”¹è®Šé¡è‰²
- å±éšªç­‰ç´šæ–‡å­—ï¼ˆå®‰å…¨/ä½å±éšª/ä¸­ç­‰å±éšª/é«˜å±éšª/æ¥µåº¦å±éšªï¼‰

**äº‹ä»¶è¨‚é–±**ï¼š
```csharp
DangerousManager.Instance.OnDangerLevelChanged += UpdateDangerUI;
DangerousManager.Instance.OnDangerLevelTypeChanged += UpdateDangerColor;
```

### ItemSlotUIï¼ˆç‰©å“å¿«æ·éµï¼‰

**åŠŸèƒ½**ï¼š
- é¡¯ç¤ºç•¶å‰è£å‚™çš„ç‰©å“
- é¡¯ç¤ºç‰©å“åœ–ç¤ºå’Œåç¨±
- é¡¯ç¤ºç‰©å“æ•¸é‡ï¼ˆå¦‚æœæœ‰ï¼‰
- é¡¯ç¤ºå¿«æ·éµæç¤º

**äº‹ä»¶è¨‚é–±**ï¼š
```csharp
itemHolder.OnItemChanged += UpdateItemSlot;
```

### WeaponDurabilityUI

**é¡¯ç¤º**ï¼š
- ç•¶å‰æ­¦å™¨è€ä¹…åº¦ / æœ€å¤§è€ä¹…åº¦
- è€ä¹…åº¦æ¢ï¼ˆé€²åº¦æ¢ï¼‰
- æ ¹æ“šè€ä¹…åº¦ç™¾åˆ†æ¯”æ”¹è®Šé¡è‰²
- ä½è€ä¹…åº¦æ™‚é–ƒçˆè­¦å‘Š

**äº‹ä»¶è¨‚é–±**ï¼š
```csharp
itemHolder.OnWeaponDurabilityChanged += UpdateDurabilityUI;
itemHolder.OnWeaponBroken += OnWeaponBroken;
```

### PauseMenuUI

**åŠŸèƒ½**ï¼š
- é¡¯ç¤ºæš«åœé¸å–®
- ç¹¼çºŒéŠæˆ²
- é‡æ–°é–‹å§‹
- è¿”å›ä¸»é¸å–®
- é€€å‡ºéŠæˆ²

**äº‹ä»¶è¨‚é–±**ï¼š
```csharp
GameManager.Instance.OnGameStateChanged += OnGameStateChanged;
```

### UI æ›´æ–°æµç¨‹

```
éŠæˆ²é‚è¼¯è®ŠåŒ–
    â†“
è§¸ç™¼äº‹ä»¶
    â†“
UI çµ„ä»¶ç›£è½äº‹ä»¶
    â†“
æ›´æ–° UI é¡¯ç¤º
```

**å„ªé»**ï¼š
- UI èˆ‡éŠæˆ²é‚è¼¯è§£è€¦
- æ˜“æ–¼æ“´å±•å’Œç¶­è­·
- æ”¯æ´å¤šå€‹ UI åŒæ™‚ç›£è½

---

## éŠæˆ²ç©æ³•æ©Ÿåˆ¶

### 1. æ½›è¡Œæ©Ÿåˆ¶

#### è¹²ä¸‹ç³»çµ±
**å¯¦ä½œç‹€æ…‹**ï¼šâœ… åŸºç¤å¯¦ä½œå®Œæˆ

**åŠŸèƒ½**ï¼š
- æŒ‰ C éµåˆ‡æ›è¹²ä¸‹
- è¹²ä¸‹æ™‚ç§»å‹•é€Ÿåº¦æ¸›åŠ
- è¨ˆåŠƒï¼šè¹²ä¸‹å¯èº²é¿é«˜åº¦éšœç¤™ç‰©

**ç¨‹å¼ç¢¼**ï¼š
```csharp
// PlayerMovement.cs
[SerializeField] private float squatSpeedMultiplier = 0.5f;
private bool isSquatting = false;
public void ToggleSquat()
```

#### è¦–é‡ç³»çµ±
- ç©å®¶è¦–é‡ç¯„åœï¼š8 æ ¼
- ç©å®¶è¦–é‡è§’åº¦ï¼š90 åº¦
- æ•µäººè¦–é‡ï¼šå¯èª¿æ•´
- è¦–é‡æ–¹å‘è·Ÿéš¨ç§»å‹•æ–¹å‘

### 2. æˆ°é¬¥æ©Ÿåˆ¶

#### æ”»æ“Šç³»çµ±

**è¿‘æˆ°æ­¦å™¨**ï¼š
- ç¯„åœæ”»æ“Šï¼ˆæ‰‡å½¢å€åŸŸï¼‰
- ç«‹å³åˆ¤å®š
- ç„¡éœ€å½ˆè—¥

**é ç¨‹æ­¦å™¨**ï¼š
- ç™¼å°„å­å½ˆï¼ˆç‰©ç†ç§»å‹•ï¼‰
- å­å½ˆç¢°æ’åˆ¤å®š
- éœ€è¦å½ˆè—¥ï¼ˆè€ä¹…åº¦ç³»çµ±ï¼‰

#### å‚·å®³ç³»çµ±

**æµç¨‹**ï¼š
```
Weapon.TryPerformAttack()
    â†“
MeleeWeapon: ç¯„åœæª¢æ¸¬æ‰€æœ‰ç¢°æ’é«”
RangedWeapon: ç”Ÿæˆå­å½ˆ
    â†“
ç¢°æ’æª¢æ¸¬ï¼ˆBullet æˆ–ç›´æ¥æª¢æ¸¬ï¼‰
    â†“
ç›®æ¨™.TakeDamage()
    â†“
è¡€é‡æ¸›å°‘
    â†“
æ­»äº¡è™•ç†
```

**æ”»æ“Šå†·å»**ï¼š
- æ¯å€‹æ­¦å™¨æœ‰ç¨ç«‹çš„å†·å»æ™‚é–“
- é˜²æ­¢é€£çºŒæ”»æ“Š

#### ææ§æ©Ÿåˆ¶ï¼ˆè¨ˆåŠƒä¸­ï¼‰
**å¾…å¯¦ä½œ**ï¼šåŠ å…¥ææ§ CD
- ç›®å‰ï¼šå¯ä»¥ç«‹å³ææ§
- è¨ˆåŠƒï¼šåˆ‡æ›æ­¦å™¨éœ€è¦æ™‚é–“
- ç›®çš„ï¼šé¿å…ã€Œä¸€ç›´ç©ºæ‰‹å†ç¬é–“ææ§ã€çš„æœ€ä½³ç­–ç•¥

### 3. ç‰©å“ç®¡ç†

#### èƒŒåŒ…ç³»çµ±
- æ”¯æ´å¤šå€‹ç‰©å“
- Q éµåˆ‡æ›ç‰©å“
- æ‰‹ä¸Šæ²’ç‰©å“æ™‚è‡ªå‹•è£å‚™æ’¿åˆ°çš„ç‰©å“

#### æ’¿å–ç³»çµ±
- E éµæ’¿å–
- ç¯„åœæª¢æ¸¬ï¼ˆ2 æ ¼ï¼‰
- è‡ªå‹•æ‰¾æœ€è¿‘çš„ç‰©å“
- å„ªå…ˆæ’¿å–ç‰©å“ï¼Œå…¶æ¬¡é–‹é–€

#### æ‰è½ç³»çµ±
- å¯¦é«”æ­»äº¡æ™‚è‡ªå‹•æ‰è½
- åœ“å½¢æ•£è½ï¼ˆåŠå¾‘ 1.5 æ ¼ï¼‰
- ä¿ç•™ç‰©å“å±¬æ€§ï¼ˆå¦‚å‰©é¤˜å½ˆè—¥ï¼‰

### 4. é–€ç³»çµ±

**DoorController**ï¼š
- ç®¡ç†å ´æ™¯ä¸­æ‰€æœ‰çš„é–€
- E éµé–‹é–€ï¼ˆåœ¨é–€é™„è¿‘ï¼‰
- æ”¯æ´é‘°åŒ™ç³»çµ±ï¼ˆè¨ˆåŠƒä¸­ï¼‰

### 5. å‹åˆ©æ¢ä»¶

**å…©æ­¥é©Ÿå‹åˆ©**ï¼š
1. âœ… æ“Šæ®ºç›®æ¨™ï¼ˆTarget æ­»äº¡ï¼‰
2. âœ… è¿”å›å‡ºç”Ÿé»ï¼ˆè·é›¢ <= 2 æ ¼ï¼‰

**æª¢æŸ¥é »ç‡**ï¼šæ¯ 0.5 ç§’æª¢æŸ¥ä¸€æ¬¡

**ç¨‹å¼ç¢¼**ï¼š
```csharp
// Player.cs
private void CheckGameEndConditions()
{
    if (IsDead) return;
    if (targetObject == null) return;
    
    if (IsTargetDead() && IsPlayerAtSpawnPoint())
    {
        Win();
    }
}
```

### 6. æ­»äº¡æ‡²ç½°

**ç©å®¶æ­»äº¡**ï¼š
- éŠæˆ²çµæŸ
- 2 ç§’å¾Œè¿”å›ä¸»é¸å–®

**æ•µäººæ­»äº¡**ï¼š
- æ‰è½æ‰€æœ‰ç‰©å“
- é€šçŸ¥ GameManagerï¼ˆæ“Šæ®ºæ•¸ +1ï¼‰

---

## æŠ€è¡“äº®é»

### 1. æ¨¡çµ„åŒ–æ¶æ§‹

**çµ±ä¸€çš„çµ„ä»¶æ¥å£**ï¼š
- æ‰€æœ‰å¯¦é«”ä½¿ç”¨ç›¸åŒçš„çµ„ä»¶æ¶æ§‹
- æ˜“æ–¼æ“´å±•æ–°çš„å¯¦é«”é¡å‹
- çµ„ä»¶å¯ç¨ç«‹æ¸¬è©¦å’Œç¶­è­·

**æŠ½è±¡å±¤æ¬¡æ¸…æ™°**ï¼š
```
æŠ½è±¡åŸºé¡ï¼ˆå®šç¾©æ¥å£ï¼‰
    â†“
å…·é«”å¯¦ç¾é¡ï¼ˆå¯¦ç¾åŠŸèƒ½ï¼‰
    â†“
å¯¦é«”é¡ï¼ˆçµ„åˆçµ„ä»¶ï¼‰
```

### 2. æ³›å‹ç‹€æ…‹æ©Ÿ

**å„ªé»**ï¼š
- æ”¯æ´ä»»æ„æšèˆ‰é¡å‹
- å‹åˆ¥å®‰å…¨
- ä»£ç¢¼é‡ç”¨æ€§é«˜

**è¨­è¨ˆ**ï¼š
```csharp
public abstract class BaseStateMachine<TState> where TState : System.Enum
{
    protected TState currentState;
    public event Action<TState, TState> OnStateChanged;
    public abstract void ChangeState(TState newState);
}
```

### 3. äº‹ä»¶é©…å‹•æ¶æ§‹

**å„ªé»**ï¼š
- é™ä½çµ„ä»¶é–“è€¦åˆ
- æ”¯æ´å¤šå€‹ç›£è½è€…
- æ˜“æ–¼æ“´å±•

**æ‡‰ç”¨å ´æ™¯**ï¼š
- è¡€é‡è®ŠåŒ– â†’ UI æ›´æ–°
- å±éšªä¿‚æ•¸è®ŠåŒ– â†’ UI æ›´æ–°
- æ­¦å™¨æå£ â†’ è‡ªå‹•åˆ‡æ›
- ç©å®¶æ­»äº¡ â†’ éŠæˆ²çµæŸ

### 4. å‘å¾Œå…¼å®¹è¨­è¨ˆ

**ç­–ç•¥**ï¼š
- ä¿ç•™èˆŠ API ä½œç‚ºåŒ…è£å™¨
- æ·»åŠ  `Obsolete` æ¨™è¨˜ï¼ˆè¨ˆåŠƒä¸­ï¼‰
- é€æ­¥é·ç§»åˆ°æ–° API

**ç¤ºä¾‹**ï¼š
```csharp
// æ–° API
public Item CurrentItem => currentItem;
public event Action<Item> OnItemChanged;

// å‘å¾Œå…¼å®¹çš„èˆŠ API
public Weapon CurrentWeapon => currentItem as Weapon;
public event Action<Weapon> OnWeaponChanged;
```

### 5. æ€§èƒ½å„ªåŒ–

#### æ›´æ–°é »ç‡æ§åˆ¶
```csharp
// ä¸æ˜¯æ¯å¹€æ›´æ–°
if (Time.time - lastUpdateTime >= updateInterval)
{
    Update();
    lastUpdateTime = Time.time;
}
```

#### æ•¸æ“šå¿«å–
```csharp
// å¿«å–å¸¸ç”¨æ•¸æ“šï¼Œæ¸›å°‘è¨ˆç®—
private Vector2 cachedPosition;
private float cacheUpdateTime = 0f;
```

#### éŒ¯é–‹æ›´æ–°æ™‚é–“
```csharp
// EnemyManager ç‚ºæ¯å€‹æ•µäººè¨­å®šä¸åŒçš„åˆå§‹æ›´æ–°æ™‚é–“
lastAIUpdateTime = Time.time + Random.Range(0f, aiUpdateInterval);
```

#### è¦–è¦ºåŒ–æ§åˆ¶
```csharp
// åªç‚ºå¯è¦‹çš„æ•µäººç¹ªè£½ Gizmos
enemy.SetCanVisualize(canVisualize);
```

### 6. è³‡æ–™é©…å‹•è¨­è¨ˆ

**å„ªé»**ï¼š
- é—œå¡æ•¸æ“šèˆ‡ä»£ç¢¼åˆ†é›¢
- æ˜“æ–¼ç·¨è¼¯å’Œç‰ˆæœ¬æ§åˆ¶
- æ”¯æ´å¤–éƒ¨å·¥å…·ç”Ÿæˆ

**æ–‡ä»¶æ ¼å¼**ï¼š
- ç´”æ–‡å­—ï¼ˆtxtï¼‰
- CSV æ ¼å¼
- è¨»é‡‹æ”¯æ´ï¼ˆ# é–‹é ­ï¼‰

### 7. å–®ä¾‹ç®¡ç†å™¨æ¨¡å¼

**æ‡‰ç”¨**ï¼š
- GameManager
- DangerousManager
- ItemManager

**å„ªé»**ï¼š
- å…¨å±€è¨ªå•é»
- è·¨å ´æ™¯æŒä¹…åŒ–ï¼ˆDontDestroyOnLoadï¼‰
- é¿å…é‡è¤‡å¯¦ä¾‹

**å¯¦ä½œ**ï¼š
```csharp
public static GameManager Instance { get; private set; }

private void Awake()
{
    if (Instance == null)
    {
        Instance = this;
        DontDestroyOnLoad(gameObject);
    }
    else
    {
        Destroy(gameObject);
    }
}
```

### 8. å»¶é²åŸ·è¡Œæ¨¡å¼

**å ´æ™¯**ï¼š
- æ­¦å™¨æå£æ™‚å»¶é²éŠ·æ¯€ï¼ˆç­‰å¾…äº‹ä»¶è™•ç†å®Œæˆï¼‰
- ç©å®¶æ­»äº¡/å‹åˆ©å¾Œå»¶é²è¿”å›ä¸»é¸å–®

**å¯¦ä½œ**ï¼š
```csharp
// å»¶é²éŠ·æ¯€
Destroy(gameObject, 0.1f);

// å»¶é²åŸ·è¡Œ
StartCoroutine(ReturnToMainMenuAfterDelay(2f));
```

---

## æª”æ¡ˆçµæ§‹

```
Assets/script/
â”œâ”€â”€ Architecture/                    # æ¶æ§‹æ–‡æª”
â”‚   â”œâ”€â”€ ProjectArchitecture.md      # æœ¬æ–‡æª”
â”‚   â”œâ”€â”€ SharedComponentsProposal.md # å…±ç”¨çµ„ä»¶ææ¡ˆ
â”‚   â”œâ”€â”€ Todo.md                      # å¾…è¾¦äº‹é …
â”‚   â””â”€â”€ KeyboardControls.md         # éµç›¤æ§åˆ¶èªªæ˜
â”‚
â”œâ”€â”€ Entity/                          # å¯¦é«”åŸºç¤ç³»çµ±
â”‚   â”œâ”€â”€ BaseEntity.cs               # å¯¦é«”åŸºé¡ï¼ˆ248è¡Œï¼‰
â”‚   â”œâ”€â”€ BaseMovement.cs             # ç§»å‹•åŸºé¡
â”‚   â”œâ”€â”€ BaseDetection.cs            # åµæ¸¬åŸºé¡
â”‚   â”œâ”€â”€ BaseStateMachine.cs         # ç‹€æ…‹æ©ŸåŸºé¡
â”‚   â”œâ”€â”€ BaseVisualizer.cs           # è¦–è¦ºåŒ–åŸºé¡
â”‚   â””â”€â”€ README.md                   # å¯¦é«”ç³»çµ±èªªæ˜
â”‚
â”œâ”€â”€ Player/                          # ç©å®¶ç³»çµ±
â”‚   â”œâ”€â”€ Player.cs                   # ç©å®¶ä¸»æ§åˆ¶å™¨ï¼ˆ816è¡Œï¼‰
â”‚   â”œâ”€â”€ PlayerMovement.cs           # ç©å®¶ç§»å‹•ï¼ˆ297è¡Œï¼‰
â”‚   â”œâ”€â”€ PlayerDetection.cs          # ç©å®¶åµæ¸¬
â”‚   â”œâ”€â”€ PlayerState.cs              # ç©å®¶ç‹€æ…‹æ©Ÿ
â”‚   â””â”€â”€ PlayerVisualizer.cs         # ç©å®¶è¦–è¦ºåŒ–
â”‚
â”œâ”€â”€ Enemy/                           # æ•µäººç³»çµ±
â”‚   â”œâ”€â”€ Enemy.cs                    # æ•µäººä¸»æ§åˆ¶å™¨ï¼ˆ960è¡Œï¼‰
â”‚   â”œâ”€â”€ EnemyMovement.cs            # æ•µäººç§»å‹•ï¼ˆ542è¡Œï¼‰â­ v2.1 ç°¡åŒ–
â”‚   â”œâ”€â”€ EnemyDetection.cs           # æ•µäººåµæ¸¬ï¼ˆ295è¡Œï¼‰
â”‚   â”œâ”€â”€ EnemyState.cs               # æ•µäººç‹€æ…‹æ©Ÿï¼ˆ96è¡Œï¼‰
â”‚   â”œâ”€â”€ EnemyVisualizer.cs          # æ•µäººè¦–è¦ºåŒ–ï¼ˆ103è¡Œï¼‰
â”‚   â”œâ”€â”€ EnemyAttackController.cs    # æ•µäººæ”»æ“Šæ§åˆ¶ï¼ˆ60è¡Œï¼‰
â”‚   â””â”€â”€ Pathfinding/                # è·¯å¾‘è¦åŠƒ
â”‚       â”œâ”€â”€ GreedyPathfinding.cs
â”‚       â”œâ”€â”€ PathfindingGrid.cs
â”‚       â””â”€â”€ PathfindingNode.cs
â”‚
â”œâ”€â”€ Item/                            # ç‰©å“ç³»çµ±
â”‚   â”œâ”€â”€ Item.cs                     # ç‰©å“åŸºé¡ï¼ˆ40è¡Œï¼‰
â”‚   â”œâ”€â”€ ItemHolder.cs               # ç‰©å“ç®¡ç†å™¨ï¼ˆ731è¡Œï¼‰
â”‚   â”œâ”€â”€ WorldItem.cs                # å ´æ™¯ç‰©å“
â”‚   â””â”€â”€ å¿«é€Ÿè¨­å®šæŒ‡å—.md
â”‚
â”œâ”€â”€ Weapon/                          # æ­¦å™¨ç³»çµ±
â”‚   â”œâ”€â”€ Weapon.cs                   # æ­¦å™¨åŸºé¡ï¼ˆ155è¡Œï¼‰
â”‚   â”œâ”€â”€ MeleeWeapon.cs              # è¿‘æˆ°æ­¦å™¨åŸºé¡
â”‚   â”œâ”€â”€ RangedWeapon.cs             # é ç¨‹æ­¦å™¨åŸºé¡
â”‚   â”œâ”€â”€ Knife.cs                    # å°åˆ€
â”‚   â”œâ”€â”€ Gun.cs                      # æ§
â”‚   â”œâ”€â”€ Bullet.cs                   # å­å½ˆ
â”‚   â”œâ”€â”€ BulletController.cs         # å­å½ˆæ§åˆ¶å™¨
â”‚   â””â”€â”€ IAmmoWeapon.cs              # å½ˆè—¥æ­¦å™¨ä»‹é¢
â”‚
â”œâ”€â”€ Camera/                          # æ”å½±æ©Ÿç³»çµ±
â”‚   â””â”€â”€ CameraController2D.cs      # 2D æ”å½±æ©Ÿæ§åˆ¶å™¨ï¼ˆ303è¡Œï¼‰
â”‚
â”œâ”€â”€ Dangerous/                       # å±éšªä¿‚æ•¸ç³»çµ±
â”‚   â”œâ”€â”€ DangerousManager.cs        # å±éšªä¿‚æ•¸ç®¡ç†å™¨ï¼ˆ397è¡Œï¼‰
â”‚   â””â”€â”€ DangerousExample.cs        # ä½¿ç”¨ç¯„ä¾‹
â”‚
â”œâ”€â”€ Game/                            # éŠæˆ²ç®¡ç†ç³»çµ±
â”‚   â”œâ”€â”€ PlayerManager.cs           # ç©å®¶ç®¡ç†å™¨
â”‚   â”œâ”€â”€ EnemyManager.cs            # æ•µäººç®¡ç†å™¨
â”‚   â””â”€â”€ ItemManager.cs             # ç‰©å“ç®¡ç†å™¨ï¼ˆ646è¡Œï¼‰
â”‚
â”œâ”€â”€ UI/                              # UI ç³»çµ±
â”‚   â”œâ”€â”€ GameUIManager.cs           # UI ç¸½ç®¡ç†å™¨
â”‚   â”œâ”€â”€ PlayerHealthUI.cs          # ç©å®¶è¡€é‡ UI
â”‚   â”œâ”€â”€ DangerousUI.cs             # å±éšªä¿‚æ•¸ UI
â”‚   â”œâ”€â”€ ItemSlotUI.cs              # ç‰©å“æ¬„ UI
â”‚   â”œâ”€â”€ WeaponDurabilityUI.cs      # æ­¦å™¨è€ä¹…åº¦ UI
â”‚   â”œâ”€â”€ PauseMenuUI.cs             # æš«åœé¸å–® UI
â”‚   â”œâ”€â”€ MainMenuUI.cs              # ä¸»é¸å–® UI
â”‚   â””â”€â”€ LoadingProgressUI.cs       # è¼‰å…¥é€²åº¦ UI
â”‚
â”œâ”€â”€ Door/                            # é–€ç³»çµ±
â”‚   â”œâ”€â”€ Door.cs                    # é–€çµ„ä»¶
â”‚   â”œâ”€â”€ DoorController.cs          # é–€æ§åˆ¶å™¨
â”‚   â””â”€â”€ DoorSystem_README.md       # é–€ç³»çµ±èªªæ˜
â”‚
â”œâ”€â”€ Data/                            # éŠæˆ²è³‡æ–™
â”‚   â”œâ”€â”€ patroldata.txt             # æ•µäººå·¡é‚è·¯å¾‘è³‡æ–™
â”‚   â””â”€â”€ itemdata.txt               # ç‰©å“ä½ç½®è³‡æ–™
â”‚
â”œâ”€â”€ GameManager.cs                   # éŠæˆ²ç¸½ç®¡ç†å™¨ï¼ˆ503è¡Œï¼‰
â”œâ”€â”€ SceneLoader.cs                   # å ´æ™¯è¼‰å…¥å™¨
â””â”€â”€ SceneLoaderCallback.cs           # å ´æ™¯è¼‰å…¥å›èª¿
```

---

## ç¸½çµ

### æ¶æ§‹å„ªå‹¢

1. âœ… **é«˜åº¦æ¨¡çµ„åŒ–** - çµ„ä»¶ç¨ç«‹ã€è·è²¬æ¸…æ™°
2. âœ… **æ˜“æ–¼æ“´å±•** - çµ±ä¸€æ¥å£ã€æŠ½è±¡è¨­è¨ˆ
3. âœ… **ä»£ç¢¼é‡ç”¨** - å…±ç”¨åŸºé¡ã€æ³›å‹è¨­è¨ˆ
4. âœ… **ç¶­è­·æ€§é«˜** - æ¶æ§‹æ¸…æ™°ã€æ–‡æª”å®Œæ•´
5. âœ… **æ€§èƒ½å„ªåŒ–** - æ›´æ–°é »ç‡æ§åˆ¶ã€æ•¸æ“šå¿«å–
6. âœ… **äº‹ä»¶é©…å‹•** - è§£è€¦åˆã€æ˜“æ–¼æ¸¬è©¦
7. âœ… **è³‡æ–™é©…å‹•** - é—œå¡æ•¸æ“šå¤–éƒ¨åŒ–

### å·²å®ŒæˆåŠŸèƒ½

- âœ… å¯¦é«”åŸºç¤æ¶æ§‹ï¼ˆBaseEntity ç³»çµ±ï¼‰
- âœ… ç©å®¶æ§åˆ¶ç³»çµ±ï¼ˆç§»å‹•ã€æ”»æ“Šã€æ’¿å–ï¼‰
- âœ… æ•µäºº AI ç³»çµ±ï¼ˆå®Œæ•´ç‹€æ…‹æ©Ÿï¼‰
- âœ… **æ™ºèƒ½è¿½æ“Šç³»çµ±ï¼ˆv2.1ï¼‰** â­ æ–°å¢
  - ç›´ç·šè¿½æ“Šå„ªå…ˆç­–ç•¥
  - åŸºæ–¼è·é›¢çš„è·¯å¾‘æ›´æ–°
  - è‡ªå‹•ä½ç½®èª¿æ•´ç³»çµ±
  - AI æ±ºç­–èˆ‡ç§»å‹•åˆ†é›¢
- âœ… æ­¦å™¨èˆ‡ç‰©å“ç³»çµ±ï¼ˆå¤šç‰©å“åˆ‡æ›ï¼‰
- âœ… å±éšªä¿‚æ•¸ç³»çµ±ï¼ˆéš±æ€§åé¥‹ï¼‰
- âœ… æ”å½±æ©Ÿç³»çµ±ï¼ˆé›™æ¨¡å¼ï¼‰
- âœ… ç‰©å“æ‰è½èˆ‡æ’¿å–
- âœ… è·¯å¾‘è¦åŠƒç³»çµ±
- âœ… UI ç³»çµ±ï¼ˆè¡€é‡ã€å±éšªã€ç‰©å“æ¬„ï¼‰
- âœ… å‹åˆ©æ¢ä»¶æª¢æŸ¥
- âœ… è³‡æ–™é©…å‹•é—œå¡è¨­è¨ˆ

### å¾…å¯¦ç¾åŠŸèƒ½

åƒè¦‹ `Todo.md` æ–‡ä»¶ï¼Œä¸»è¦åŒ…æ‹¬ï¼š

**ç°¡å–®ä»»å‹™**ï¼š
- ææ§ CD
- æ”å½±æ©Ÿé‚Šç·£é™åˆ¶å¼·åŒ–
- æ–°å¢æ•µäººé¡å‹

**ä¸­ç­‰é›£åº¦**ï¼š
- å°åœ°åœ–ç³»çµ±
- è­¦æˆ’å€åŸŸ
- å€åˆ†å¹³æ°‘/å®ˆè¡›

**å›°é›£ä»»å‹™**ï¼š
- è¦–è§’æ”¹ç‚ºéä¿¯è¦–ï¼ˆ3Dï¼‰
- é¡é ­ç§»å‹•æ©Ÿåˆ¶å¼·åŒ–
- 3D æ¨¡å‹èˆ‡ Shader
- ç›®æ¨™é€ƒäº¡ AI

---

## é™„éŒ„

### ç›¸é—œæ–‡æª”

- `SharedComponentsProposal.md` - å…±ç”¨çµ„ä»¶æ¶æ§‹ææ¡ˆ
- `Todo.md` - å¾…è¾¦äº‹é …åˆ—è¡¨
- `KeyboardControls.md` - éµç›¤æ§åˆ¶èªªæ˜
- `Entity/README.md` - å¯¦é«”ç³»çµ±èªªæ˜
- `Item/å¿«é€Ÿè¨­å®šæŒ‡å—.md` - ç‰©å“ç³»çµ±è¨­å®šæŒ‡å—

### ç¨‹å¼ç¢¼çµ±è¨ˆ

**ä¸»è¦æ–‡ä»¶è¡Œæ•¸**ï¼š
- BaseEntity.cs: 248 è¡Œ
- Player.cs: 816 è¡Œ
- Enemy.cs: 960 è¡Œ
- ItemHolder.cs: 731 è¡Œ
- ItemManager.cs: 646 è¡Œ
- EnemyMovement.cs: 542 è¡Œ â­ v2.1 ç°¡åŒ–ï¼ˆåŸ 604 è¡Œï¼‰
- GameManager.cs: 503 è¡Œ
- DangerousManager.cs: 397 è¡Œ
- CameraController2D.cs: 303 è¡Œ
- EnemyDetection.cs: 295 è¡Œ
- PlayerMovement.cs: 297 è¡Œ

**ç¸½è¨ˆ**ï¼šç´„ 5900+ è¡Œæ ¸å¿ƒä»£ç¢¼

### ç¶­è­·å»ºè­°

1. **ä¿æŒæ–‡æª”æ›´æ–°** - é‡å¤§è®Šæ›´æ™‚åŒæ­¥æ›´æ–°æ­¤æ–‡æª”
2. **éµå¾ªæ¶æ§‹è¨­è¨ˆ** - æ–°åŠŸèƒ½æ‡‰ç¬¦åˆç¾æœ‰æ¶æ§‹
3. **ç·¨å¯«å–®å…ƒæ¸¬è©¦** - ç‚ºæ ¸å¿ƒçµ„ä»¶ç·¨å¯«æ¸¬è©¦
4. **æ€§èƒ½ç›£æ§** - å®šæœŸæª¢æŸ¥æ€§èƒ½ç“¶é ¸
5. **ä»£ç¢¼å¯©æŸ¥** - ä¿æŒä»£ç¢¼è³ªé‡

---

**æ–‡æª”ç‰ˆæœ¬**ï¼šv2.1  
**æœ€å¾Œæ›´æ–°**ï¼š2025-11-03  
**ç¶­è­·è€…**ï¼šé–‹ç™¼åœ˜éšŠ

---

## v2.1 æ›´æ–°æ—¥èªŒï¼ˆ2025-11-03ï¼‰

### æ™ºèƒ½è¿½æ“Šç³»çµ±é‡æ§‹

**æ ¸å¿ƒæ”¹é€²**ï¼š
1. **ç›´ç·šè¿½æ“Šå„ªå…ˆç­–ç•¥**
   - ä½¿ç”¨ Physics2D.CircleCast æª¢æ¸¬éšœç¤™ç‰©
   - æ¯ 0.1 ç§’æª¢æŸ¥ä¸€æ¬¡è·¯å¾‘
   - ç„¡éšœç¤™æ™‚ç›´æ¥è¿½æ“Šï¼Œå¤§å¹…æå‡æµæš¢åº¦

2. **åŸºæ–¼è·é›¢çš„è·¯å¾‘æ›´æ–°**
   - å¾å›ºå®šæ™‚é–“ï¼ˆ0.2 ç§’ï¼‰æ”¹ç‚ºå›ºå®šè·é›¢ï¼ˆ1 å–®ä½ï¼‰
   - éœæ­¢æ™‚ä¸æµªè²» CPU è¨ˆç®—è·¯å¾‘
   - å‹•æ…‹èª¿æ•´æ›´æ–°é »ç‡

3. **AI æ±ºç­–èˆ‡ç§»å‹•åˆ†é›¢**
   - AI æ±ºç­–ï¼š0.15 ç§’æ›´æ–°ä¸€æ¬¡
   - ç§»å‹•åŸ·è¡Œï¼šæ¯å¹€æ›´æ–°
   - è§£æ±ºã€Œè¨­ç½®é€Ÿåº¦å¾Œç«‹å³åœæ­¢ã€å•é¡Œ

4. **è‡ªå‹•ä½ç½®èª¿æ•´ç³»çµ±**
   - è™•ç†è²¼ç‰†ç©å®¶å’Œæ•µäººç¢°æ’é«”å•é¡Œ
   - è‡ªå‹•æœç´¢æœ€è¿‘å¯è¡Œèµ°ç¯€é»
   - ç¢ºä¿è·¯å¾‘è¦åŠƒç¸½èƒ½æˆåŠŸ

5. **ä»£ç¢¼ç°¡åŒ–**
   - EnemyMovement.csï¼š604 è¡Œ â†’ 542 è¡Œï¼ˆ-62 è¡Œï¼Œ-10%ï¼‰
   - ç§»é™¤å†—é¤˜æ—¥èªŒå’Œé‡è¤‡ä»£ç¢¼
   - åˆä½µ Walls å’Œ Obstacles LayerMask
   - ç§»é™¤ pathfinding åºåˆ—åŒ–å­—æ®µï¼ˆè‡ªå‹•æŸ¥æ‰¾ï¼‰

**æ€§èƒ½æå‡**ï¼š
- ç›´ç·šè¿½æ“Šæ™‚ CPU è² è¼‰æ¥µä½
- è·¯å¾‘è¨ˆç®—æ¬¡æ•¸æ¸›å°‘ 50%+
- è¿½æ“Šæµæš¢åº¦é¡¯è‘—æå‡

**Bug ä¿®å¾©**ï¼š
- âœ… ä¿®å¾©è¿‘è·é›¢è¿½æ“Šæ™‚è¡éé ­æˆ–åœä½çš„å•é¡Œ
- âœ… ä¿®å¾©ç©å®¶è²¼ç‰†æ™‚è·¯å¾‘è¦åŠƒå¤±æ•—çš„å•é¡Œ
- âœ… ä¿®å¾©æ•µäººä½ç½®è¢«åˆ¤å®šç‚ºä¸å¯è¡Œèµ°çš„å•é¡Œ

